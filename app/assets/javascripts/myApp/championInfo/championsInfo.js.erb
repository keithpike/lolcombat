/**
* championSelector Module
*
* Description
*/
angular.module('championInfo', [
	'models.champions',
	'mgcrea.ngStrap.popover',
	'ngSanitize'
])

	.config(function($stateProvider){
		$stateProvider
			.state('appStart.champions', {
				url: '/champions',
				views: {
				 	'': {
				 		templateUrl: "<%= asset_path('myApp/championInfo/championInfo.html') %>",
				 		controller: 'ChampionsController as championsController'
				 	},
				 	'navbar': {
				 		templateUrl: "<%= asset_path('myApp/navbar/navbar.html') %>",
				 	},
					'footer': {
						templateUrl: "<%= asset_path('myApp/footer/footer.html') %>",
					}
				},
				resolve: {
					championsData: function(ChampionsModel) {
						return ChampionsModel.getChampions()
							.then(function(result) {
								return result;
							});
					},
					currentChampion: function($stateParams, ChampionsModel) {
						return ChampionsModel.resetCurrentChampion();
					}
				}
			})

			.state('appStart.champions.selected', {
				//TODO: provide slugs for search term
				url: '/:key',
				views: {
					'@appStart': {
						templateUrl: "<%= asset_path('myApp/championInfo/championInfo.selected.html') %>",
						controller: 'DetailedChampionsController as championsController'
					},
				 	'navbar': {
				 		templateUrl: "<%= asset_path('myApp/navbar/navbar.html') %>",
				 	},
					'footer': {
						templateUrl: "<%= asset_path('myApp/footer/footer.html') %>",
					}
				},
				resolve: {

					championData: function($stateParams, ChampionsModel){
						return ChampionsModel.getChampion($stateParams.key)
							.then(function(result){
								return result;
							});
					},

					currentChampion: function($stateParams, ChampionsModel, championData){
						return ChampionsModel.setCurrentChampion($stateParams.key);
					}


				}
			});


	})
	// TODO: reference template so tooltips can read out template instead of inline
	// .run(function($templateCache) {
	//   $templateCache.put('championTooltip.html',
	//   	'<div class="championTooltipContainer"><span class="championTooltipName">{{ championsController.getName($index) }}</span></br><span class="championTooltipDescription">{{ championsController.getDescription($index) }}</span></div>'
	//   	);
	// })

	.controller('ChampionsController', function(ChampionsModel, $stateParams, championsData){
		var championsController = this;

		championsController.championsData = championsData;
		championsController.getCurrentChampion = ChampionsModel.getCurrentChampion;
		championsController.getCurrentChampionImage = ChampionsModel.getCurrentChampionImage;
		championsController.getImage = ChampionsModel.getChampionImage;
		championsController.getId = ChampionsModel.getChampionId;
		championsController.getName = ChampionsModel.getChampionName;
		championsController.getBlurb = ChampionsModel.getChampionBlurb;
		championsController.getTitle = ChampionsModel.getChampionTitle;
	})

		.controller('DetailedChampionsController', function(ChampionsModel, $stateParams, championData){
		var championsController = this;

		championsController.championData = championData;

		championsController.getCurrentChampion = ChampionsModel.getCurrentChampion;
		championsController.getCurrentChampionImage = ChampionsModel.getCurrentChampionImage;
		championsController.getImage = ChampionsModel.getChampionImage;
		championsController.getId = ChampionsModel.getChampionId;
		championsController.getName = ChampionsModel.getChampionName;
		championsController.getTitle = ChampionsModel.getChampionTitle;
		championsController.getstats = function(champion) {
			stats = ChampionsModel.getChampionStats(champion);
			_.each(stats, function(stat){
				return 
			})
		};
		championsController.getChampionDisplay = function(champion){

		};
			
	})
;